è¿™æ˜¯ä¸€ä¸ªä¸º GitHub å‡†å¤‡çš„å®Œæ•´ README.md æ–‡æœ¬ï¼Œæ‚¨å¯ä»¥ç›´æ¥å¤åˆ¶ç²˜è´´ä½¿ç”¨ã€‚DM Adversarial Transferability (PyTorch)This repository provides the PyTorch implementation of the DMFAA (Diversified Multi-stage Flatness-Aware Aggregation) adversarial attack framework. The method significantly enhances adversarial transferability by integrating diversified sampling, cross-stage momentum reuse, and flatness-aware aggregation, achieving state-of-the-art performance in black-box attacks.âœ¨ Key FeaturesThe DMFAA framework incorporates several novel techniques:Orthogonal Diversified Initialization (OODI): Used to guide the perturbation search into diverse, high-transferability regions.Cross-Stage Momentum Reuse: Ensures gradient consistency and prevents overfitting to the surrogate model's features across multiple attack stages.Flatness-Aware Aggregation (FAA): Estimates the local flatness of the loss landscape for each perturbation variant (from Stages 1 and 2) and aggregates them based on inverse flatness weights, resulting in a more robust final adversarial example.ğŸ“‚ Project StructureFile/DirectoryDescriptionmain.pyThe main script implementing the complete DMFAA attack logic.data/images/Directory where all input images for the attack should be placed.data/images.csvThe annotation file (CSV) linking image filenames to their ground-truth labels.torch_nets/Directory containing the PyTorch model definitions.README.mdThis document.ğŸ› ï¸ Setup and Prerequisites1. DependenciesInstall the necessary Python packages:Bashpip install torch torchvision numpy pandas pillow
2. Model FilesThe attack leverages pre-trained models converted from TensorFlow (e.g., tf2torch_inception_v3, tf2torch_ens_adv_inc_res_v2).Model Source: The model definitions and conversion tools are typically derived from projects like ylhz/tf_to_pytorch_model.Action:Obtain the required PyTorch model definition files and place them in the torch_nets/ directory.Obtain the corresponding pre-trained weight files (e.g., .npy files) and ensure the paths in main.py are correctly pointing to these files.3. Data SetupEnsure your dataset is correctly set up:Place all input images inside data/images/.Verify that data/images.csv is correctly formatted to link image file names with their integer labels, as expected by the CustomDataset class.ğŸš€ UsageConfigure: Open main.py and verify the data paths and model weight paths (csv_file, root_dir, weight_file) are correct for your system.Run the Attack:Bashpython main.py
OutputThe script will execute the DMFAA attack in batches. The results will be:Console Output: Prints the final average Attack Success Rate (ASR).Log File: Detailed batch-wise results (e.g., Batch 0: Attack Rate 0.9800) are appended to the log file specified in main.py (e.g., xxxv3-ensv3_results.txt).ğŸ“„ Algorithm HighlightsThe aggregation step uses Local Flatness Estimation (Algorithm 1) and Flatness-Aware Aggregation (FAA) to weight the results of the multi-stage attack:Algorithm ComponentDescriptionAlgorithm 1: Local Flatness EstimationCalculates the local flatness by estimating the standard deviation of the cross-entropy loss over a small Gaussian neighborhood of the adversarial sample.FAA FormulaWeights are computed via a soft-max over the inverse flatness scores: $\lambda_s = \frac{\exp(-\text{flatness}_s)}{\sum_k \exp(-\text{flatness}_k)}$ to prioritize perturbations found in flatter regions.
